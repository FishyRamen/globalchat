<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>tonkotsu.online</title>
  <style>
    :root{
      --bg: #0b0e14;
      --bg2:#0a0c12;
      --panel: rgba(15,19,28,.92);
      --panel2: rgba(12,16,24,.86);
      --stroke: rgba(255,255,255,.08);
      --stroke2: rgba(255,255,255,.12);
      --text: rgba(235,240,248,.92);
      --muted: rgba(235,240,248,.58);
      --muted2: rgba(235,240,248,.42);
      --accent: rgba(140,170,255,.95);
      --good: rgba(96, 224, 165, .9);
      --warn: rgba(255, 90, 90, .92);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --radius: 16px;
    }

    *{ box-sizing: border-box; }
    html,body{ height:100%; margin:0; }
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1200px 900px at 15% 10%, #0e1320 0%, var(--bg) 55%, var(--bg2) 100%);
      color: var(--text);
      overflow:hidden;
      cursor: none; /* custom cursor always */
    }

    /* Dots background (login + app) */
    .dots{
      position: fixed;
      inset:0;
      background-image:
        radial-gradient(rgba(255,255,255,.05) 1px, transparent 1px);
      background-size: 26px 26px;
      opacity: .55;
      pointer-events:none;
      filter: contrast(105%);
    }
    .vignette{
      position: fixed;
      inset:0;
      background: radial-gradient(900px 650px at 50% 35%, transparent 0%, rgba(0,0,0,.55) 80%);
      pointer-events:none;
    }

    /* Centered app wrapper ‚Äî leaves background visible */
    .stage{
      position: relative;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }

    .shell{
      width: min(1080px, 92vw);
      height: min(720px, 86vh);
      display:flex;
      flex-direction:column;
      gap:12px;
      animation: pop .18s ease-out;
    }

    @keyframes pop{
      from{ transform: translateY(8px); opacity:0; }
      to{ transform:none; opacity:1; }
    }

    .card{
      background: var(--panel);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    /* Top bar */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 10px 12px;
      background: rgba(9,12,18,.62);
      border-bottom: 1px solid var(--stroke);
    }
    .brand{
      font-weight: 900;
      letter-spacing: .2px;
      font-size: 14px;
      color: rgba(238,242,250,.92);
      display:flex;
      align-items:center;
      gap:10px;
      white-space:nowrap;
    }
    .brand .pill{
      border: 1px solid var(--stroke2);
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 12px;
      color: var(--muted);
      background: rgba(0,0,0,.18);
    }

    .rightTools{
      display:flex;
      align-items:center;
      gap:10px;
    }

    .iconBtn{
      width: 34px;
      height: 34px;
      border-radius: 10px;
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.16);
      color: var(--text);
      display:grid;
      place-items:center;
      font-weight: 900;
      user-select:none;
      position:relative;
    }
    .iconBtn:hover{ border-color: var(--stroke2); }

    .badge{
      position:absolute;
      top:-6px;
      right:-6px;
      min-width: 18px;
      height: 18px;
      padding: 0 6px;
      border-radius: 999px;
      background: var(--warn);
      color: rgba(10,10,10,.96);
      font-size: 12px;
      font-weight: 900;
      display:none;
      align-items:center;
      justify-content:center;
      border: 2px solid rgba(0,0,0,.5);
    }

    /* User dropdown */
    .userChip{
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.14);
      border-radius: 12px;
      padding: 7px 10px;
      font-size: 13px;
      font-weight: 850;
      display:flex;
      align-items:center;
      gap:8px;
      user-select:none;
      max-width: 280px;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .dotStatus{
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--good);
      flex: 0 0 auto;
      opacity:.95;
    }
    .dotStatus.idle{ background: rgba(255, 204, 90, .95); }
    .dotStatus.dnd{ background: rgba(255, 90, 90, .95); }
    .dotStatus.invisible{ background: rgba(200,200,200,.35); }

    .menu{
      position:absolute;
      top: 46px;
      right: 12px;
      width: 220px;
      border-radius: 14px;
      background: rgba(12,16,24,.98);
      border: 1px solid var(--stroke2);
      box-shadow: 0 14px 40px rgba(0,0,0,.6);
      padding: 6px;
      display:none;
      z-index: 20;
    }
    .menu button{
      width:100%;
      text-align:left;
      padding: 10px 10px;
      border:0;
      border-radius: 10px;
      background: transparent;
      color: var(--text);
      font-weight: 850;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .menu button:hover{
      background: rgba(255,255,255,.05);
    }
    .menu .minor{
      color: var(--muted);
      font-weight: 800;
      font-size: 12px;
    }

    /* Main layout: sidebar + content */
    .main{
      flex: 1 1 auto;
      display:flex;
      min-height:0;
      background: rgba(0,0,0,.04);
    }

    .sidebar{
      width: 280px;
      min-width: 240px;
      border-right: 1px solid var(--stroke);
      background: rgba(9,12,18,.52);
      padding: 10px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .sectionTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      color: var(--muted);
      font-size: 12px;
      font-weight: 900;
      letter-spacing: .2px;
      padding: 4px 2px;
    }

    .list{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-height:0;
      overflow:auto;
      padding-right: 4px;
    }

    .row{
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.12);
      border-radius: 12px;
      padding: 8px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      user-select:none;
    }
    .row:hover{ border-color: var(--stroke2); background: rgba(0,0,0,.16); }
    .row .left{
      display:flex;
      align-items:center;
      gap:8px;
      min-width:0;
    }
    .row .name{
      font-size: 13px;
      font-weight: 900;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 170px;
    }
    .row .mini{
      color: var(--muted2);
      font-size: 12px;
      font-weight: 800;
      white-space:nowrap;
    }

    .content{
      flex: 1 1 auto;
      display:flex;
      flex-direction:column;
      min-width:0;
      min-height:0;
      background: rgba(0,0,0,.02);
    }

    .contentHeader{
      padding: 10px 12px;
      border-bottom: 1px solid var(--stroke);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background: rgba(9,12,18,.44);
    }
    .contentHeader .title{
      font-size: 13px;
      font-weight: 950;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .contentHeader .sub{
      font-size: 12px;
      color: var(--muted);
      font-weight: 800;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 45%;
    }

    .chat{
      flex: 1 1 auto;
      min-height:0;
      overflow:auto;
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap: 8px;
    }

    .message{
      max-width: 78%;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.14);
      font-size: 13px;
      line-height: 1.35;
      animation: msgin .14s ease-out;
    }
    @keyframes msgin{
      from{ transform: translateY(6px); opacity:0; }
      to{ transform:none; opacity:1; }
    }
    .message.me{ align-self:flex-end; background: rgba(22,28,44,.26); }
    .message.other{ align-self:flex-start; }

    .msgUser{
      font-weight: 950;
      font-size: 12px;
      margin-bottom: 2px;
      color: rgba(235,240,248,.9);
      display:flex;
      gap:8px;
      align-items:center;
      min-width:0;
    }
    .msgUser span{
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 220px;
    }
    .msgMeta{
      color: var(--muted2);
      font-weight: 850;
      font-size: 11px;
    }
    .msgText{ font-weight: 850; color: rgba(233,238,245,.92); word-break: break-word; }

    .blurred{
      filter: blur(6px);
    }
    .revealHint{
      margin-top: 6px;
      color: var(--muted);
      font-size: 11px;
      font-weight: 850;
    }

    .composer{
      border-top: 1px solid var(--stroke);
      padding: 10px;
      display:flex;
      gap:8px;
      align-items:center;
      background: rgba(9,12,18,.50);
    }
    .input{
      flex: 1 1 auto;
      min-width:0;
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.16);
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--text);
      font-weight: 850;
      outline:none;
      font-size: 13px;
    }
    .sendBtn{
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.16);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 950;
      user-select:none;
    }
    .sendBtn:hover{ border-color: var(--stroke2); }

    .cooldown{
      font-size: 12px;
      color: var(--muted);
      font-weight: 850;
      min-width: 110px;
      text-align:right;
    }

    .shake{
      animation: shake .28s linear;
      border-color: var(--warn) !important;
    }
    @keyframes shake{
      0%{ transform:translateX(0) }
      25%{ transform:translateX(-4px) }
      50%{ transform:translateX(4px) }
      75%{ transform:translateX(-3px) }
      100%{ transform:translateX(0) }
    }

    /* Login screen */
    .loginWrap{
      width: min(520px, 92vw);
      margin: auto;
      padding: 14px;
      transform-origin: center;
    }
    .loginCard{
      padding: 16px;
    }
    .loginTitle{
      font-size: 18px;
      font-weight: 950;
      letter-spacing: .2px;
    }
    .loginSub{
      margin-top: 4px;
      font-size: 12px;
      color: var(--muted);
      font-weight: 800;
    }
    .fields{
      margin-top: 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .fieldRow{
      display:flex;
      gap:10px;
    }
    .field{
      width:100%;
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.14);
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--text);
      font-weight: 850;
      outline:none;
      font-size: 13px;
    }
    .pwWrap{
      position: relative;
      width:100%;
    }
    .eye{
      position:absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      width: 34px;
      height: 34px;
      border-radius: 12px;
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.12);
      display:grid;
      place-items:center;
      font-weight: 950;
      color: rgba(235,240,248,.82);
      user-select:none;
    }
    .eye:hover{ border-color: var(--stroke2); }
    .loginBtns{
      display:flex;
      gap:10px;
      margin-top: 12px;
    }
    .btn{
      flex:1;
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.14);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 950;
      user-select:none;
      text-align:center;
    }
    .btn:hover{ border-color: var(--stroke2); }
    .err{
      margin-top: 10px;
      color: rgba(255, 120, 120, .95);
      font-weight: 900;
      font-size: 12px;
      min-height: 16px;
    }

    /* Footer (kofi + rights) */
    .footerNote{
      margin-top: 10px;
      text-align:center;
      color: var(--muted2);
      font-size: 12px;
      font-weight: 800;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .footerNote a{
      color: rgba(210,225,255,.86);
      text-decoration:none;
      font-weight: 900;
    }
    .footerNote a:hover{ text-decoration: underline; }

    /* Modals */
    .modalBack{
      position: fixed;
      inset:0;
      background: rgba(0,0,0,.60);
      display:none;
      align-items:center;
      justify-content:center;
      z-index: 50;
      padding: 16px;
    }
    .modal{
      width: min(520px, 92vw);
      max-height: min(560px, 86vh);
      overflow:auto;
      border-radius: 16px;
      background: rgba(12,16,24,.98);
      border: 1px solid var(--stroke2);
      box-shadow: 0 18px 60px rgba(0,0,0,.65);
    }
    .modalHead{
      padding: 12px 12px;
      border-bottom: 1px solid var(--stroke);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .modalHead .h{
      font-weight: 950;
      font-size: 13px;
    }
    .xbtn{
      width: 34px;
      height: 34px;
      border-radius: 12px;
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.12);
      color: var(--text);
      display:grid;
      place-items:center;
      font-weight: 950;
      user-select:none;
    }
    .xbtn:hover{ border-color: var(--stroke2); }
    .modalBody{
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .kv{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:center;
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: 10px 10px;
      background: rgba(0,0,0,.12);
    }
    .kv .k{
      color: var(--muted);
      font-size: 12px;
      font-weight: 900;
    }
    .kv .v{
      font-weight: 950;
      font-size: 12px;
      color: rgba(235,240,248,.92);
      max-width: 60%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      text-align:right;
    }

    .sliderRow{
      display:flex;
      flex-direction:column;
      gap:8px;
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: 10px;
      background: rgba(0,0,0,.12);
    }
    .sliderTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .sliderTop .k{
      color: var(--muted);
      font-size: 12px;
      font-weight: 900;
    }
    .sliderTop .v{
      color: rgba(235,240,248,.85);
      font-size: 12px;
      font-weight: 950;
      min-width: 44px;
      text-align:right;
    }
    input[type="range"]{
      width:100%;
      accent-color: rgba(160,185,255,.95);
      height: 22px;
      cursor:none;
    }

    .toggleRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: 10px;
      background: rgba(0,0,0,.12);
    }
    .toggleRow .k{
      color: var(--muted);
      font-size: 12px;
      font-weight: 900;
    }
    .toggleRow select, .toggleRow input[type="checkbox"]{
      background: rgba(0,0,0,.12);
      border: 1px solid var(--stroke);
      color: var(--text);
      border-radius: 10px;
      padding: 8px 10px;
      font-weight: 900;
      cursor:none;
    }

    .actionsRow{
      display:flex;
      gap:10px;
    }
    .actionsRow .btn{
      flex:1;
    }

    /* Reduce animations */
    .noAnim *{
      animation: none !important;
      transition: none !important;
      scroll-behavior: auto !important;
    }

    /* Custom cursor elements */
    .cursorDot, .cursorTrail{
      position: fixed;
      left: 0;
      top: 0;
      pointer-events: none;
      z-index: 9999;
      transform: translate(-50%, -50%);
      mix-blend-mode: normal;
    }
    .cursorDot{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: rgba(235,240,248,.95);
      box-shadow: 0 0 0 6px rgba(140,170,255,.12);
      opacity: 0;
    }
    .cursorTrail{
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 2px solid rgba(235,240,248,.78);
      opacity: 0;
    }

    /* Loading overlay */
    .loaderBack{
      position: fixed;
      inset:0;
      background: rgba(0,0,0,.62);
      display:none;
      align-items:center;
      justify-content:center;
      z-index: 60;
    }
    .loader{
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: 3px solid rgba(255,255,255,.12);
      border-top-color: rgba(160,185,255,.95);
      animation: spin .7s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }

    /* Right-click context menu (mute) */
    .ctx{
      position: fixed;
      z-index: 100;
      display:none;
      width: 200px;
      padding: 6px;
      border-radius: 14px;
      background: rgba(12,16,24,.98);
      border: 1px solid var(--stroke2);
      box-shadow: 0 18px 60px rgba(0,0,0,.65);
    }
    .ctx button{
      width:100%;
      text-align:left;
      padding: 10px 10px;
      border:0;
      border-radius: 10px;
      background: transparent;
      color: var(--text);
      font-weight: 900;
    }
    .ctx button:hover{ background: rgba(255,255,255,.05); }

    /* Scrollbar subtle */
    ::-webkit-scrollbar { width: 10px; }
    ::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,.08);
      border-radius: 999px;
      border: 3px solid transparent;
      background-clip: padding-box;
    }
    ::-webkit-scrollbar-thumb:hover{ background: rgba(255,255,255,.12); background-clip: padding-box; }

    /* Make sure native cursor never shows on hover */
    button, a, input, select, textarea, .row, .iconBtn, .userChip, .eye { cursor: none !important; }
  </style>
</head>

<body>
  <div class="dots"></div>
  <div class="vignette"></div>

  <div class="cursorDot" id="cursorDot"></div>
  <div class="cursorTrail" id="cursorTrail"></div>

  <div class="loaderBack" id="loaderBack"><div class="loader"></div></div>

  <div class="ctx" id="ctx">
    <button id="ctxMuteBtn">Mute</button>
  </div>

  <div class="modalBack" id="modalBack">
    <div class="modal" id="modal">
      <div class="modalHead">
        <div class="h" id="modalTitle">Modal</div>
        <button class="xbtn" id="modalClose">‚úï</button>
      </div>
      <div class="modalBody" id="modalBody"></div>
    </div>
  </div>

  <div class="stage">

    <!-- LOGIN VIEW -->
    <div class="loginWrap" id="loginView">
      <div class="card loginCard" id="loginCard">
        <div class="loginTitle">tonkotsu.online</div>
        <div class="loginSub">Sign in or continue as guest. Minimal, compact, and fast.</div>

        <div class="fields">
          <input class="field" id="userField" placeholder="Username (3-20, letters/numbers/_/.)" autocomplete="username" />
          <div class="pwWrap">
            <input class="field" id="passField" placeholder="Password (min 4)" type="password" autocomplete="current-password" />
            <div class="eye" id="eyeBtn" title="Show/Hide">üëÅ</div>
          </div>
          <div class="loginBtns">
            <div class="btn" id="loginBtn">Login / Create</div>
            <div class="btn" id="guestBtn">Guest</div>
          </div>
          <div class="err" id="loginErr"></div>
        </div>
      </div>

      <div class="footerNote">
        <div><a href="https://ko-fi.com/fishy_x1" target="_blank" rel="noopener">Support on Ko-fi</a></div>
        <div>¬© <span id="year"></span> tonkotsu.online ‚Äî All rights reserved.</div>
      </div>
    </div>

    <!-- APP VIEW -->
    <div class="shell card" id="appView" style="display:none;">
      <div class="topbar">
        <div class="brand">
          <span>tonkotsu.online</span>
          <span class="pill" id="activePill">Global</span>
        </div>

        <div class="rightTools">
          <button class="iconBtn" id="inboxBtn" title="Inbox">
            ‚åÅ
            <div class="badge" id="inboxBadge">0</div>
          </button>
          <button class="iconBtn" id="leaderboardBtn" title="Leaderboard">üèÜ</button>

          <div style="position:relative;">
            <div class="userChip" id="userChip">
              <div class="dotStatus" id="statusDot"></div>
              <div id="meName" style="min-width:0; overflow:hidden; text-overflow:ellipsis;"></div>
              <div style="opacity:.6;">‚ñæ</div>
            </div>
            <div class="menu" id="userMenu">
              <button id="menuProfile"><span>Profile</span><span class="minor">View</span></button>
              <button id="menuSettings"><span>Settings</span><span class="minor">Adjust</span></button>
              <button id="menuLogout"><span>Log out</span><span class="minor">Exit</span></button>
            </div>
          </div>
        </div>
      </div>

      <div class="main">
        <div class="sidebar" id="sidebar">
          <div class="sectionTitle">
            <span>Messages</span>
            <span class="mini" id="msgCountMini"></span>
          </div>
          <div class="list" id="messagesList"></div>

          <div class="sectionTitle">
            <span>Online users</span>
            <span class="mini" id="onlineCountMini"></span>
          </div>
          <div class="list" id="onlineList"></div>
        </div>

        <div class="content">
          <div class="contentHeader">
            <div>
              <div class="title" id="chatTitle">Global</div>
              <div class="sub" id="chatSub">Everyone can talk here. Mentions ping your inbox.</div>
            </div>
            <div class="cooldown" id="cooldownText"></div>
          </div>

          <div class="chat" id="chat"></div>

          <div class="composer">
            <input class="input" id="msgInput" placeholder="Message‚Ä¶ (use @username for mentions)" />
            <button class="sendBtn" id="sendBtn">Send</button>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="app.js"></script>
  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
</body>
</html>
