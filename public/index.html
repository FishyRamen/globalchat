<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>tonkotsu.online</title>

  <style>
    :root{
      --bg:#0b0d10;
      --panel:rgba(255,255,255,.03);
      --panel2:rgba(255,255,255,.02);
      --stroke:#1c232c;
      --stroke2:#273140;
      --text:#e8edf3;
      --muted:#9aa7b3;
      --warn:#ff5252;
      --ok:#48d18c;

      --pad:12px;
      --font:13px;

      --shadow: 0 12px 40px rgba(0,0,0,.45);
      --radius:16px;
      --radius2:14px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font: 500 var(--font)/1.3 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      overflow:hidden;
      cursor: none; /* custom cursor default; can be turned off in settings */
    }

    /* Star background */
    .bg{
      position:fixed; inset:0;
      background: radial-gradient(1000px 800px at 20% 15%, rgba(255,255,255,.06), transparent 55%),
                  radial-gradient(900px 900px at 85% 65%, rgba(255,255,255,.04), transparent 60%);
      overflow:hidden;
      pointer-events:none;
    }
    .stars, .stars2, .stars3{
      position:absolute; inset:-200px;
      background-repeat:repeat;
      background-size: 260px 260px;
      opacity:.7;
      filter: blur(.0px);
      animation: drift 90s linear infinite;
    }
    .stars{
      background-image:
        radial-gradient(1px 1px at 40px 60px, rgba(255,255,255,.6), transparent 40%),
        radial-gradient(1px 1px at 90px 120px, rgba(255,255,255,.7), transparent 40%),
        radial-gradient(1px 1px at 170px 40px, rgba(255,255,255,.5), transparent 40%),
        radial-gradient(1px 1px at 220px 190px, rgba(255,255,255,.6), transparent 40%);
    }
    .stars2{
      background-size: 340px 340px;
      opacity:.45;
      animation-duration: 140s;
      background-image:
        radial-gradient(1px 1px at 70px 90px, rgba(255,255,255,.6), transparent 40%),
        radial-gradient(1px 1px at 140px 220px, rgba(255,255,255,.5), transparent 40%),
        radial-gradient(1px 1px at 260px 110px, rgba(255,255,255,.7), transparent 40%);
    }
    .stars3{
      background-size: 520px 520px;
      opacity:.25;
      animation-duration: 200s;
      background-image:
        radial-gradient(1px 1px at 160px 170px, rgba(255,255,255,.6), transparent 40%),
        radial-gradient(1px 1px at 340px 260px, rgba(255,255,255,.5), transparent 40%),
        radial-gradient(1px 1px at 420px 80px, rgba(255,255,255,.65), transparent 40%);
    }
    @keyframes drift {
      from{ transform: translate3d(0,0,0); }
      to{ transform: translate3d(-260px, -260px, 0); }
    }

    /* Centered shell (compact; not full-screen) */
    .shell{
      position:fixed; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 28px;
    }
    .card{
      width:min(980px, 100%);
      height:min(720px, 100%);
      border:1px solid var(--stroke);
      border-radius: 20px;
      background: rgba(10,12,14,.78);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      display:flex;
      overflow:hidden;
      transform: translateZ(0);
    }

    /* Login overlay */
    .overlay{
      position:absolute; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(6px);
      z-index: 50;
      opacity:1;
      transition: opacity .25s ease;
    }
    .overlay.hidden{ pointer-events:none; opacity:0; }
    .loginCard{
      width:min(420px, 92vw);
      border:1px solid var(--stroke);
      border-radius: 18px;
      background: rgba(12,14,17,.88);
      box-shadow: var(--shadow);
      padding: 18px;
      display:flex;
      flex-direction:column;
      gap:12px;
      transform: scale(1);
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .loginCard:hover{
      transform: scale(1.01);
      box-shadow: 0 16px 55px rgba(0,0,0,.52);
    }
    .brandRow{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .brand{
      font-weight:950;
      letter-spacing:.2px;
      font-size:16px;
      white-space:nowrap;
    }
    .muted{ color:var(--muted); font-size:12px; }

    .field{
      width:100%;
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid var(--stroke2);
      background: rgba(255,255,255,.03);
      color:var(--text);
      outline:none;
    }
    .field:focus{ border-color: rgba(255,255,255,.18); }

    .row{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding: 10px 10px;
      border-radius: 14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.02);
      cursor:pointer;
      user-select:none;
    }
    .row:hover{ background: rgba(255,255,255,.03); }

    .btn{
      border:1px solid var(--stroke2);
      background: rgba(255,255,255,.03);
      color:var(--text);
      padding: 9px 12px;
      border-radius: 12px;
      cursor:pointer;
      user-select:none;
    }
    .btn:hover{ background: rgba(255,255,255,.05); }
    .btn.primary{
      border-color: rgba(255,255,255,.22);
      background: rgba(255,255,255,.08);
    }
    .btn.small{
      padding: 7px 10px;
      border-radius: 11px;
      font-size:12px;
    }

    .passRow{ position:relative; }
    .eye{
      position:absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      padding: 6px 8px;
      border-radius: 10px;
      border:1px solid var(--stroke2);
      background: rgba(255,255,255,.03);
      font-size:12px;
      cursor:pointer;
      user-select:none;
    }

    /* Main app layout */
    .layout{ flex:1; display:flex; min-width:0; }
    .sidebar{
      width: 290px;
      border-right:1px solid var(--stroke);
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      min-width: 260px;
      max-width: 320px;
    }
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 12px;
      border-bottom:1px solid var(--stroke);
      min-width:0;
    }
    .main{
      flex:1;
      display:flex;
      flex-direction:column;
      min-width:0;
    }

    .pill{
      display:flex; align-items:center; gap:10px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.02);
      cursor:pointer;
      user-select:none;
      min-width:0;
      max-width: 240px;
    }
    .pillName{
      font-weight:900;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      font-size:12px;
    }
    .pillSub{
      font-size:11px;
      color:var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .dot{
      width:10px; height:10px; border-radius:99px;
      background: var(--ok);
      box-shadow: 0 0 0 3px rgba(72,209,140,.10);
      flex:0 0 auto;
    }

    .badge{
      min-width: 18px;
      height: 18px;
      padding: 0 6px;
      border-radius: 999px;
      background: var(--warn);
      color:#0b0d10;
      font-weight: 950;
      font-size: 11px;
      display:none;
      align-items:center;
      justify-content:center;
    }
    .badge.show{ display:flex; }

    .sectionTitle{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      color:#dbe6f1;
      font-size:12px;
      font-weight:950;
      margin-top:4px;
    }

    .scroll{
      overflow:auto;
      min-height:0;
      padding-right: 2px;
    }
    .scroll::-webkit-scrollbar{ width:10px; }
    .scroll::-webkit-scrollbar-thumb{ background: rgba(255,255,255,.08); border-radius:99px; border:3px solid transparent; background-clip: content-box; }

    .list{ display:flex; flex-direction:column; gap:8px; }

    .rowLeft{ display:flex; gap:10px; align-items:center; min-width:0; }
    .nameCol{ min-width:0; }
    .rowName{ font-weight:900; font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .rowSub{ font-size:11px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

    .statusDot{
      width:10px; height:10px; border-radius:99px;
      background: rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.12);
      flex:0 0 auto;
    }
    .statusDot.on{
      background: var(--ok);
      border-color: rgba(72,209,140,.25);
      box-shadow: 0 0 0 3px rgba(72,209,140,.10);
    }

    /* Chat */
    .chatHeader{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding: 12px;
      border-bottom:1px solid var(--stroke);
      min-width:0;
    }
    .chatTitle{
      font-weight:950;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      font-size:12px;
    }
    .chatHint{ font-size:11px; color:var(--muted); }

    .chatBox{
      flex:1;
      padding: 12px;
      overflow:auto;
      min-height:0;
    }

    .msg{
      display:flex;
      margin-bottom: 10px;
    }
    .bubble{
      max-width: 70%;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.02);
      border-radius: 14px;
      padding: 10px 10px;
    }
    .meta{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-bottom: 6px;
    }
    .u{
      font-weight:950;
      font-size:12px;
      cursor:pointer;
      user-select:none;
    }
    .t{
      font-size:11px;
      color:var(--muted);
      flex:0 0 auto;
    }
    .body{
      font-size:12px;
      color: var(--text);
      white-space:pre-wrap;
      word-break:break-word;
    }

    .composer{
      border-top:1px solid var(--stroke);
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .composerRow{
      display:flex; gap:10px;
    }
    .composerRow .field{ flex:1; }

    .cooldown{
      display:none;
      align-items:center;
      gap:10px;
      color: var(--muted);
      font-size:11px;
      user-select:none;
    }
    .bar{
      flex:1;
      height: 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      overflow:hidden;
    }
    .barFill{
      width:0%;
      height:100%;
      background: rgba(255,255,255,.18);
      transition: width .06s linear;
    }
    .cooldown.warn{ color: var(--warn); }
    .shake{ animation: shake .35s ease; }
    @keyframes shake{
      0%,100%{ transform: translateX(0); }
      20%{ transform: translateX(-4px); }
      40%{ transform: translateX(4px); }
      60%{ transform: translateX(-3px); }
      80%{ transform: translateX(3px); }
    }

    /* Modals */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(6px);
      display:none;
      align-items:center;
      justify-content:center;
      z-index: 60;
      padding: 18px;
    }
    .modalBack.show{ display:flex; }
    .modal{
      width:min(520px, 96vw);
      border:1px solid var(--stroke);
      border-radius: 18px;
      background: rgba(12,14,17,.92);
      box-shadow: var(--shadow);
      padding: 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      max-height: min(70vh, 560px);
      overflow:auto;
    }
    .modalTop{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .modalTitle{
      font-weight:950;
      font-size:13px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* Toasts */
    .toasts{
      position:fixed;
      right: 16px;
      bottom: 16px;
      display:flex;
      flex-direction:column;
      gap:10px;
      z-index: 80;
      pointer-events:none;
    }
    .toast{
      pointer-events:none;
      width: min(320px, 92vw);
      border:1px solid var(--stroke);
      border-radius: 14px;
      background: rgba(12,14,17,.92);
      box-shadow: var(--shadow);
      padding: 10px 10px;
      display:flex;
      gap:10px;
      transform: translateY(0);
      opacity:1;
      transition: opacity .25s ease, transform .25s ease;
    }
    .toastDot{
      width:10px; height:10px; border-radius:99px;
      background: var(--ok);
      box-shadow: 0 0 0 3px rgba(72,209,140,.10);
      margin-top: 2px;
      flex:0 0 auto;
    }
    .toastTitle{ font-weight:950; font-size:12px; }
    .toastMsg{ color:var(--muted); font-size:12px; }

    /* Footer under whole box */
    .footer{
      position:fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 10px;
      display:flex;
      align-items:center;
      gap:12px;
      color: rgba(255,255,255,.55);
      font-size: 11px;
      z-index: 10;
      user-select:none;
    }
    .footer a{ color: rgba(255,255,255,.70); text-decoration:none; }
    .footer a:hover{ text-decoration:underline; }

    /* Loading screen (between login and app) */
    .loading{
      position:absolute; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(6px);
      z-index: 55;
    }
    .loading.show{ display:flex; }
    .loader{
      width:min(360px, 90vw);
      border:1px solid var(--stroke);
      border-radius: 18px;
      background: rgba(12,14,17,.92);
      box-shadow: var(--shadow);
      padding: 16px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .spinner{
      width: 18px; height: 18px;
      border-radius: 999px;
      border:2px solid rgba(255,255,255,.16);
      border-top-color: rgba(255,255,255,.60);
      animation: spin .7s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(360deg);} }

    /* Custom cursor */
    .cursorDot, .cursorRing, .cursorTrail{
      position:fixed;
      left:0; top:0;
      transform: translate(-50%,-50%);
      pointer-events:none;
      z-index: 9999;
      will-change: transform, opacity;
    }
    .cursorDot{
      width:8px; height:8px;
      border-radius: 99px;
      background: rgba(255,255,255,.85);
      opacity:.9;
    }
    .cursorRing{
      width:24px; height:24px;
      border-radius: 99px;
      border:1px solid rgba(255,255,255,.35);
      opacity:.55;
    }
    .cursorTrail{
      width: 10px; height: 10px;
      border-radius: 99px;
      background: rgba(255,255,255,.28);
      filter: blur(.0px);
      opacity:.0; /* created dynamically */
    }

    /* Make sure no element shows native cursor */
    a, button, input, textarea, .row, .btn, .pill { cursor: none !important; }
  </style>
</head>

<body>
  <div class="bg">
    <div class="stars"></div>
    <div class="stars2"></div>
    <div class="stars3"></div>
  </div>

  <!-- Cursor -->
  <div id="cursorDot" class="cursorDot"></div>
  <div id="cursorRing" class="cursorRing"></div>

  <div class="shell">
    <div class="card" id="card">
      <!-- Loading -->
      <div class="loading" id="loading">
        <div class="loader">
          <div style="display:flex;align-items:center;gap:10px">
            <div class="spinner"></div>
            <div style="font-weight:950">Loading</div>
          </div>
          <div class="muted" id="loaderSub">syncing…</div>
        </div>
      </div>

      <!-- Login overlay -->
      <div class="overlay" id="loginOverlay">
        <div class="loginCard" id="loginCard">
          <div class="brandRow">
            <div class="brand">tonkotsu.online</div>
            <div class="muted">minimal chat</div>
          </div>

          <div>
            <div class="muted" style="margin-bottom:6px">Username</div>
            <input class="field" id="username" placeholder="yourname" autocomplete="username" />
          </div>

          <div class="passRow">
            <div class="muted" style="margin-bottom:6px">Password</div>
            <input class="field" id="password" type="password" placeholder="••••" autocomplete="current-password" />
            <div class="eye" id="togglePass" title="Show/Hide">◉</div>
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn primary" id="joinBtn" style="flex:1">Log in / Create</button>
            <button class="btn" id="guestBtn">Guest</button>
          </div>

          <div class="muted">
            Guests can only chat in Global and have slower cooldown.
          </div>
        </div>
      </div>

      <!-- App -->
      <div class="layout" id="app" style="display:flex; flex:1; min-width:0;">
        <div class="sidebar">
          <!-- Inbox button -->
          <div class="row" id="inboxBtn" title="Inbox (mentions, invites, friend requests)">
            <div class="rowLeft">
              <div class="statusDot on"></div>
              <div class="nameCol">
                <div class="rowName">Inbox</div>
                <div class="rowSub">mentions • invites • requests</div>
              </div>
            </div>
            <div class="badge" id="inboxPing">0</div>
          </div>

          <!-- Online users -->
          <div class="sectionTitle">
            <div>Online users</div>
            <div class="muted" id="onlineCount">0</div>
          </div>
          <div class="scroll">
            <div class="list" id="onlineList"></div>
          </div>

          <!-- Messages list -->
          <div class="sectionTitle" style="margin-top:6px">
            <div>Messages</div>
            <div style="display:flex;align-items:center;gap:10px">
              <div class="badge" id="msgPing">0</div>
              <button class="btn small" id="createGroupBtn">Create</button>
            </div>
          </div>
          <div class="scroll">
            <div class="list" id="msgList"></div>
          </div>
        </div>

        <div class="main">
          <div class="topbar">
            <div style="min-width:0">
              <div class="chatTitle" id="chatTitle">Global chat</div>
              <div class="chatHint" id="chatHint">shared with everyone</div>
            </div>

            <!-- Top right user dropdown anchor -->
            <div class="pill" id="mePill" style="display:none" title="Account menu">
              <div class="dot"></div>
              <div style="min-width:0">
                <div class="pillName" id="meName">You</div>
                <div class="pillSub" id="meSub">click for menu</div>
              </div>
            </div>
          </div>

          <div class="chatBox" id="chatBox"></div>

          <div class="composer">
            <div class="cooldown" id="cooldownRow">
              <div id="cooldownText">0.0s</div>
              <div class="bar"><div class="barFill" id="cdFill"></div></div>
            </div>

            <div class="composerRow">
              <input class="field" id="message" placeholder="Type a message…" />
              <button class="btn primary" id="sendBtn">Send</button>
            </div>

            <div class="muted" style="display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap">
              <div id="cooldownLabel">Cooldown: 3s</div>
              <div id="statusLabel">Status: Online</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer under the whole box -->
  <div class="footer">
    <a href="https://ko-fi.com/fishy_x1" target="_blank" rel="noreferrer">Support on Ko-fi</a>
    <span>•</span>
    <span>© <span id="year"></span> All rights reserved</span>
  </div>

  <!-- Modal -->
  <div class="modalBack" id="modalBack">
    <div class="modal">
      <div class="modalTop">
        <div class="modalTitle" id="modalTitle">Modal</div>
        <button class="btn small" id="modalClose">Close</button>
      </div>
      <div id="modalBody"></div>
    </div>
  </div>

  <!-- Toasts -->
  <div class="toasts" id="toasts"></div>

  <!-- socket.io client (served by server) -->
  <script src="/socket.io/socket.io.js"></script>
  <script src="/script.js"></script>
</body>
</html>

