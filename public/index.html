<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>tonkotsu.online</title>
  <style>
    :root{
      --bg:#000000; --panel:#07080b; --panel2:#050608; --line:#151a24;
      --text:#e6e8ee; --muted:#99a1b2; --accent:#6ea8fe;
      --danger:#ff4d4f; --good:#3ddc97; --warn:#f5c451; --inv:#374151;
      --shadow:0 18px 40px rgba(0,0,0,.55); --r:14px; --fs:13px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font:var(--fs)/1.22 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial}
    button,input,select,textarea{font:inherit;color:inherit;background:transparent;border:1px solid var(--line);border-radius:12px;outline:none}
    button{cursor:pointer}
    a{color:inherit;text-decoration:none}
    .app{display:grid;grid-template-columns:250px 1fr 300px;height:100vh}
    .loading{position:fixed;inset:0;z-index:2000;display:flex;align-items:center;justify-content:center;
      background:radial-gradient(1200px 800px at 50% 35%, rgba(110,168,254,.12), transparent 55%),
                 radial-gradient(900px 600px at 50% 70%, rgba(61,220,151,.08), transparent 60%),#000;
      transition:opacity .35s ease,transform .35s ease}
    .loading.hide{opacity:0;pointer-events:none;transform:translateY(-6px)}
    .loadCard{width:min(520px,92vw);padding:18px 18px 16px;border-radius:18px;border:1px solid rgba(110,168,254,.25);
      background:linear-gradient(180deg, rgba(10,12,16,.92), rgba(5,6,8,.92));box-shadow:var(--shadow);position:relative;overflow:hidden}
    .loadGlow{position:absolute;inset:-40%;background:conic-gradient(from 180deg, rgba(110,168,254,.0), rgba(110,168,254,.28), rgba(61,220,151,.16), rgba(110,168,254,.0));
      filter:blur(28px);animation:spin 2.6s linear infinite;opacity:.55}
    @keyframes spin{to{transform:rotate(360deg)}}
    .loadTop{position:relative;display:flex;align-items:center;gap:12px}
    .mark{width:44px;height:44px;border-radius:14px;border:1px solid rgba(110,168,254,.35);background:rgba(110,168,254,.10);
      display:grid;place-items:center;font-weight:900;letter-spacing:.5px}
    .brandTitle{font-size:18px;font-weight:950;letter-spacing:.2px;line-height:1.05;
      background:linear-gradient(90deg,#fff,#a7c0ff 45%,#c9f7e2);-webkit-background-clip:text;background-clip:text;color:transparent}
    .brandSub{color:var(--muted);font-size:12px;margin-top:4px}
    .loadBar{position:relative;height:6px;border-radius:99px;margin-top:14px;background:rgba(255,255,255,.08);overflow:hidden}
    .loadBar>div{height:100%;width:30%;border-radius:99px;background:linear-gradient(90deg, rgba(110,168,254,.1), rgba(110,168,254,1));
      animation:loadmove 1.1s ease-in-out infinite}
    @keyframes loadmove{0%{transform:translateX(-40%);width:22%}50%{transform:translateX(90%);width:42%}100%{transform:translateX(-40%);width:22%}}
    .side{background:linear-gradient(180deg,var(--panel),var(--panel2));border-right:1px solid var(--line);display:flex;flex-direction:column;min-width:250px}
    .brand{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid var(--line)}
    .logo{display:flex;gap:10px;align-items:center;font-weight:950;min-width:0}
    .brandName{font-size:14px;background:linear-gradient(90deg,#fff,#a7c0ff 55%,#c9f7e2);-webkit-background-clip:text;background-clip:text;color:transparent;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .dot{width:10px;height:10px;border-radius:99px;background:var(--good);box-shadow:0 0 0 2px rgba(0,0,0,.55);flex:0 0 auto}
    .dot.online{background:var(--good)} .dot.idle{background:var(--warn)} .dot.dnd{background:var(--danger)} .dot.invisible{background:var(--inv)}
    .miniBadge{padding:2px 7px;font-size:11px;border-radius:99px;border:1px solid rgba(255,255,255,.08);color:var(--muted);background:rgba(255,255,255,.02)}
    .badgeGuest{border-color:#2b2b2b;color:#c8ccd6} .badgeBeta{border-color:#264b8f;color:#a7c0ff}
    .badgeEarly{border-color:#3f2a69;color:#d6b6ff} .badgeAnn{border-color:#6a2a2a;color:#ffb3b3}
    .meRow{display:flex;gap:10px;align-items:center;padding:10px 12px;border-bottom:1px solid var(--line)}
    .meMeta{min-width:0} .meName{display:flex;align-items:center;gap:8px;font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .meStatus{color:var(--muted);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:2px}
    .meActions{margin-left:auto;display:flex;gap:6px}
    .iconBtn{width:32px;height:32px;border-radius:12px;display:grid;place-items:center;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.02);
      transition:transform .10s ease,border-color .10s ease}
    .iconBtn:hover{border-color:rgba(110,168,254,.35);transform:translateY(-1px)}
    .threadList{padding:10px;overflow:auto}
    .threadSecTitle{color:var(--muted);font-size:11px;letter-spacing:.14em;text-transform:uppercase;margin:8px 6px 8px;display:flex;align-items:center;justify-content:space-between}
    .thread{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:14px;cursor:pointer;border:1px solid transparent;user-select:none;
      transition:background .10s ease,transform .10s ease,border-color .10s ease}
    .thread:hover{background:rgba(255,255,255,.03);transform:translateX(1px)}
    .thread.active{background:rgba(110,168,254,.12);border-color:rgba(110,168,254,.22)}
    .threadName{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1 1 auto;font-weight:800}
    .ping{min-width:18px;height:18px;padding:0 6px;border-radius:99px;background:var(--danger);color:#fff;font-size:11px;display:none;align-items:center;justify-content:center;font-weight:900;box-shadow:0 6px 14px rgba(255,77,79,.18)}
    .ping.show{display:flex}
    .main{display:flex;flex-direction:column;min-width:0;background:radial-gradient(1200px 800px at 50% -10%, rgba(110,168,254,.06), transparent 55%),
      radial-gradient(900px 600px at 80% 110%, rgba(61,220,151,.05), transparent 60%),#000}
    .topbar{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--line);
      background:rgba(0,0,0,.35);backdrop-filter:blur(10px);position:sticky;top:0;z-index:20}
    .topTitle{display:flex;align-items:center;gap:10px;min-width:0}
    .topTitle h1{margin:0;font-size:14px;font-weight:950;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .sub{color:var(--muted);font-size:12px;margin-left:2px}
    .messages{flex:1 1 auto;overflow:auto;padding:12px;display:flex;flex-direction:column;gap:6px}
    .msg{display:flex;gap:10px;padding:7px 10px;border-radius:14px;border:1px solid transparent;position:relative;transition:background .10s ease,border-color .10s ease}
    .msg:hover{background:rgba(255,255,255,.02)}
    .msg.mention{border-color:rgba(255,77,79,.45);background:rgba(255,77,79,.06)}
    .msg.announcement{border-color:rgba(255,77,79,.25);background:linear-gradient(90deg, rgba(255,77,79,.10), rgba(110,168,254,.06))}
    .msg.blocked{filter:blur(6px);opacity:.82;pointer-events:none}
    .revealBtn{position:absolute;right:10px;top:10px;padding:6px 8px;border-radius:12px;border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.6);
      pointer-events:auto;filter:none!important;opacity:1!important;font-weight:900;font-size:12px}
    .msgHdr{display:flex;align-items:center;gap:8px;min-width:0}
    .msgName{font-weight:950;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer}
    .msgTime{font-size:11px;color:var(--muted);margin-left:auto;white-space:nowrap}
    .msgBody{margin-top:3px;color:var(--text);white-space:pre-wrap;word-break:break-word;line-height:1.25}
    .msgNote{color:var(--muted);font-size:11px;margin-top:2px}
    .msgCol{min-width:0;flex:1 1 auto}
    .cardInline{margin-top:8px;padding:10px;border-radius:14px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.02);display:flex;gap:8px;align-items:center;justify-content:space-between}
    .composerWrap{border-top:1px solid var(--line);padding:10px 12px 12px;background:rgba(0,0,0,.35)}
    .composer{display:flex;gap:8px;align-items:flex-end;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:8px 10px;
      transition:border-color .10s ease,transform .10s ease}
    .composer.shake{animation:shake .22s ease-in-out 2;border-color:rgba(255,77,79,.55)}
    @keyframes shake{0%{transform:translateX(0)}25%{transform:translateX(-3px)}50%{transform:translateX(3px)}75%{transform:translateX(-2px)}100%{transform:translateX(0)}}
    textarea{border:none;resize:none;width:100%;min-height:18px;max-height:140px;background:transparent;padding:0;line-height:1.25;outline:none;overflow:auto}
    .sendBtn{border:1px solid rgba(110,168,254,.35);background:rgba(110,168,254,.14);padding:7px 10px;border-radius:14px;font-weight:950;transition:transform .10s ease}
    .sendBtn:hover{transform:translateY(-1px)}
    .cooldownBar{height:4px;margin-top:10px;border-radius:99px;background:rgba(255,255,255,.08);overflow:hidden;display:none}
    .cooldownBar>div{height:100%;width:0%;background:var(--accent);transition:background .18s ease}
    .cooldownBar.red>div{background:var(--danger)} .cooldownBar.show{display:block}
    .right{background:linear-gradient(180deg,var(--panel),var(--panel2));border-left:1px solid var(--line);display:flex;flex-direction:column;min-width:280px}
    .rightHdr{padding:10px 12px;border-bottom:1px solid var(--line);display:flex;align-items:center;justify-content:space-between}
    .rightHdr h2{margin:0;font-size:12px;letter-spacing:.14em;text-transform:uppercase;color:var(--muted)}
    .onlineList{padding:10px;overflow:auto;display:flex;flex-direction:column;gap:6px}
    .userRow{display:flex;align-items:center;gap:10px;padding:9px 10px;border-radius:14px;border:1px solid transparent;cursor:pointer;
      transition:background .10s ease,transform .10s ease,border-color .10s ease}
    .userRow:hover{background:rgba(255,255,255,.03);transform:translateX(1px);border-color:rgba(255,255,255,.06)}
    .userMeta{min-width:0;flex:1 1 auto}
    .userName{display:flex;gap:8px;align-items:center;font-weight:950;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .userStatus{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:2px}
    .badgeRow{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.65);display:none;align-items:center;justify-content:center;padding:20px;z-index:1500}
    .backdrop.show{display:flex}
    .modal{width:min(560px,96vw);background:linear-gradient(180deg,#0b0e14,#050608);border:1px solid rgba(110,168,254,.22);border-radius:18px;box-shadow:var(--shadow);overflow:hidden;animation:pop .14s ease-out}
    @keyframes pop{from{transform:scale(.98);opacity:.4}to{transform:scale(1);opacity:1}}
    .modalHdr{padding:12px;border-bottom:1px solid rgba(255,255,255,.08);display:flex;align-items:center;justify-content:space-between;gap:10px}
    .modalHdr h3{margin:0;font-size:14px;font-weight:950}
    .modalBody{padding:12px;display:flex;flex-direction:column;gap:10px}
    .row{display:flex;gap:10px;align-items:center}
    .row>label{width:120px;color:var(--muted);font-size:12px}
    .row>input,.row>select{flex:1 1 auto;padding:9px 10px;border-radius:14px;background:rgba(255,255,255,.02)}
    .row>textarea{flex:1 1 auto;min-height:80px;border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:9px 10px;background:rgba(255,255,255,.02)}
    .modalFoot{padding:12px;border-top:1px solid rgba(255,255,255,.08);display:flex;justify-content:flex-end;gap:8px}
    .btn{padding:9px 11px;border-radius:14px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.02);font-weight:950;transition:transform .10s ease,border-color .10s ease}
    .btn:hover{transform:translateY(-1px);border-color:rgba(110,168,254,.22)}
    .btnPrimary{border-color:rgba(110,168,254,.35);background:rgba(110,168,254,.14)}
    .btnDanger{border-color:rgba(255,77,79,.35);background:rgba(255,77,79,.10)}
    .ctx{position:fixed;z-index:1600;min-width:200px;background:#070a12;border:1px solid rgba(110,168,254,.22);border-radius:14px;box-shadow:var(--shadow);overflow:hidden;display:none}
    .ctx.show{display:block}
    .ctxItem{padding:10px 12px;cursor:pointer;font-weight:900;font-size:13px}
    .ctxItem:hover{background:rgba(255,255,255,.04)}
    .ctxItem.danger{color:#ffb3b3}
    .toastWrap{position:fixed;bottom:16px;left:16px;display:flex;flex-direction:column;gap:8px;z-index:1700}
    .toast{background:#070a12;border:1px solid rgba(110,168,254,.18);border-radius:14px;padding:10px 12px;box-shadow:var(--shadow);max-width:min(520px,92vw);animation:pop .14s ease-out}
    .toast small{color:var(--muted);display:block;margin-top:2px}
    @media (max-width:980px){.app{grid-template-columns:230px 1fr}.right{display:none}}
    @media (max-width:720px){.app{grid-template-columns:1fr}.side{display:none}}
  </style>
</head>
<body>
  <div class="loading" id="loading">
    <div class="loadCard">
      <div class="loadGlow"></div>
      <div class="loadTop">
        <div class="mark">t.</div>
        <div>
          <div class="brandTitle">tonkotsu.online</div>
          <div class="brandSub" id="loadText">Connecting‚Ä¶</div>
        </div>
      </div>
      <div class="loadBar"><div></div></div>
    </div>
  </div>

  <div class="app">
    <aside class="side">
      <div class="brand">
        <div class="logo">
          <div class="dot online" id="meDot"></div>
          <span class="brandName">tonkotsu.online</span>
        </div>
        <span class="miniBadge" id="envBadge">BETA</span>
      </div>

      <div class="meRow">
        <div class="dot online" id="meDot2"></div>
        <div class="meMeta">
          <div class="meName" id="meName">...</div>
          <div class="meStatus" id="meStatus">...</div>
        </div>
        <div class="meActions">
          <button class="iconBtn" id="btnSettings" title="Settings">‚öôÔ∏è</button>
          <button class="iconBtn" id="btnProfile" title="Profile">üë§</button>
          <button class="iconBtn" id="btnAuth" title="Login/Register/Guest">üîê</button>
        </div>
      </div>

      <div class="threadList">
        <div class="threadSecTitle">
          <span>Chats</span>
          <button class="iconBtn" id="btnNew" title="New DM / Group">Ôºã</button>
        </div>
        <div id="threads"></div>
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="topTitle">
          <div class="dot online" id="threadDot"></div>
          <div style="min-width:0">
            <h1 id="threadTitle"># global</h1>
            <div class="sub" id="threadSub">Real-time chat</div>
          </div>
        </div>
        <div class="row" style="gap:8px">
          <button class="btn" id="btnGroup" style="display:none" title="Group settings">Group</button>
          <button class="btn" id="btnAnnounce" style="display:none" title="Announcement">üì¢ Announce</button>
          <button class="btn" id="btnLogout" style="display:none">Logout</button>
        </div>
      </div>

      <div class="messages" id="messages"></div>

      <div class="composerWrap">
        <div class="composer" id="composerWrap">
          <textarea id="composer" placeholder="Message..." rows="1"></textarea>
          <button class="sendBtn" id="sendBtn">Send</button>
        </div>
        <div class="cooldownBar" id="cooldownBar"><div id="cooldownFill"></div></div>
      </div>
    </main>

    <aside class="right">
      <div class="rightHdr">
        <h2>Online</h2>
        <span class="miniBadge" id="onlineCount">0</span>
      </div>
      <div class="onlineList" id="onlineList"></div>
    </aside>
  </div>

  <div class="backdrop" id="backdrop">
    <div class="modal" id="modal">
      <div class="modalHdr">
        <h3 id="modalTitle">Modal</h3>
        <button class="iconBtn" id="modalClose" title="Close">‚úï</button>
      </div>
      <div class="modalBody" id="modalBody"></div>
      <div class="modalFoot" id="modalFoot"></div>
    </div>
  </div>

  <div class="ctx" id="ctx"></div>
  <div class="toastWrap" id="toasts"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/script.js"></script>
</body>
</html>
